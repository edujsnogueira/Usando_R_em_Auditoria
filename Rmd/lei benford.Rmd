A lei de benford descreve a distribuição de probabilidades dos primeiros dígitos em um conjunto de dados. Entende-se por primeiro dígito o dígito mais à esquerda em um número.  Assim, o primeiro dígito no número 746 é 7, no número 32 é 3 e assim por diante.  O dígito zero não é um primeiro dígito válido. A distribuição dos primeiros dígitos é dada pela equação a seguir:

P(Di = di) = log( 1 + 1 / di );  di = 1, ..., 9
 
di     P(Di =di) 
 1	0.30103 
 2	0.17609 
 3	0.12494 
 4	0.09691 
 5	0.07918 
 6	0.06695 
 7	 0.05799
 8	0.05115 
 9	0.04576 
A Lei de Benford aplica-se a conjuntos de números que expressem os "tamanhos" de fenômenos semelhantes, como por exemplo: relações de despesas em prestações de contas de aplicação de recursos, saldos de contas no razão contábil, valores de sinistros em seguros, etc . Não é aplicável, contudo, a conjuntos de números que apresentem alguma das seguintes características:

Conjuntos de números que estejam restritos a um limite superior ou inferior, como os que representam o quociente intelectual, altura de pessoas, etc.;
Conjuntos de números que sirvam para identificação de objetos, tais como números de contas bancárias, números de telefone, números de CPF/CGC, etc.;
Conjuntos de números que tenham sido gerados aleatoriamente, tais como os resultados de loterias, bingos, etc.
O uso da Lei de Benford como técnica de auditoria na detecção de erros ou fraudes vem ganhou notoriedade a partir do trabalho de Mark Nigrini, que em sua tese de doutoramento estendeu a aplicação da Lei de Benford a dados corporativos e tem sido um entusiasta da utilização da mesma como técnica de auditoria. Sua página na internet é uma boa fonte de informações sobre a Lei de Benford e sua aplicação em Auditoria.

A Lei de Benford permite aos auditores comparar a freqüência observada de "primeiros dígitos" com a freqüência esperada sob a Lei de Benford nos dados auditados, chamando a atenção do auditor para quaisquer discrepâncias verificadas, levando-o a direcionar os trabalhos para onde forem verificadas não-conformidades com o comportamento esperado.
Para ilustrar a implementação da Lei de Benford vamos usar dados do Censo Escolar 2005(Internet2005.zip) disponível no site do INEP . Como se sabe, a quantidade de matrículas serve de base para a definição da participação de estados e municípios nos recursos do FUNDEF sendo, portanto, uma variável muito suscetível a manipulações.Vamos utilizar apenas parte dos dados,  ou seja, as colunas Unidade da Federação, Municipio, Dependência Administrativa, Número de Matrículas no Ensino Fundamental Regular na 1a a 4a séries, e 5a a 8a séries. Nosso objetivo será verificar se o número de matrículas na 1a a 4a séries e 5a a 8a séries nas escolas municipais se ajustam à Lei de Benford, o que nos dará uma indicação de que o a quantidade de matrículas informada não foi manipulada.
Após eliminarmos algumas linhas iniciais do arquivo original e as colunas que não serão utilizadas, convertemos o arquivo xls para o formato csv(CensoEscolar2005.csv), que poderá ser importado pelo R com a função read.csv2(). Esta conversão é necessária em razão do R não possuir, até o momento, função nativa para a leitura de arquivos do Excel. 

Alguns pacotes, como o xlsReadWrite, o RODBC e o Rcmdr, oferecem recursos para a importação de dados em planilhas Excel.

A importação dos dados pode ser feita da seguinte forma:

> Censo2005 <- read.csv2("CensoEscolar2005.csv", as.is=TRUE)
> str(Censo2005)
`data.frame':   20220 obs. of  5 variables:
 $ UF           : chr  "Brasil" "Brasil" "Brasil" "Brasil" ...
 $ Municipio    : chr  "Total" "Total" "Total" "Total" ...
 $ DepAdm       : chr  "Total" "Estadual" "Federal" "Municipal" ...
 $ EnsinoFund1_4: chr  "13.521.834" "3.103.985" "4.847" "8.684.296" ...
 $ EnsinoFund5_8: chr  "11.898.908" "6.292.068" "14.938" "4.075.338" ...

A função str() nos permite identificar o número de registros (linhas) e de variáveis (colunas) existentes no conjunto de dados importado. Também mostra os nomes nas variáveis e o tipo de cada uma delas.

Observe que as variáveis EnsinoFund1_4 e EnsinoFund5_8 que representam o número de matrículas na 1a a 4a séries e 5a a 8a séries do ensino fundamental não são numéricas como seria de se esperar. Isto ocorre porque na planilha de onde importamos os dados os números estavam representados tendo o ponto por separador de milhar. Para contornar este inconveniente, que ocorre com rezoável freqüência na importação de dados, escrevi a função convNum() que converte os dados para o formato numérico. Seu uso é ilustrado a seguir:

> Censo2005$EnsinoFund1_4 <- convNum(Censo2005$EnsinoFund1_4)
> Censo2005$EnsinoFund5_8 <- convNum(Censo2005$EnsinoFund5_8)
> str(Censo2005)
`data.frame':   20220 obs. of  5 variables:
 $ UF           : chr  "Brasil" "Brasil" "Brasil" "Brasil" ...
 $ Municipio    : chr  "Total" "Total" "Total" "Total" ...
 $ DepAdm       : chr  "Total" "Estadual" "Federal" "Municipal" ...
 $ EnsinoFund1_4: num  13521834  3103985     4847  8684296  1728706 ...
 $ EnsinoFund5_8: num  11898908  6292068    14938  4075338  1516564 ...

Na base de dados, alguns registros referem-se a totalizações como pode ser visto a seguir:

> unique(Censo2005$UF)
 [1] "Brasil"              "Acre"                "Alagoas"            
 [4] "Amapa"               "Amazonas"            "Bahia"              
 [7] "Ceara"               "Distrito Federal"    "Espirito Santo"     
[10] "Goias"               "Maranhao"            "Mato Grosso"        
[13] "Mato Grosso do Sul"  "Minas Gerais"        "Para"               
[16] "Paraiba"             "Paraná"              "Pernambuco"         
[19] "Piaui"               "Rio Grande do Norte" "Rio Grande do Sul"  
[22] "Rio de Janeiro"      "Rondonia"            "Roraima"            
[25] "Santa Catarina"      "Sergipe"             "São Paulo"          
[28] "Tocantins"          

> unique(Censo2005$DepAdm)
[1] "Total"     "Estadual"  "Federal"   "Municipal" "Privada"  

> unique(Censo2005$Municipio)[1:10]
[1] "Total"           "ACRELANDIA"      "ASSIS BRASIL"    "BRASILEIA"      
[5] "BUJARI"          "CAPIXABA"        "CRUZEIRO DO SUL" "EPITACIOLANDIA" 
[9] "FEIJO"           "JORDAO"    

Para retirar estas totalizações da base de dados será necessário filtrá-la conforme mostrado a seguir:

> Censo2005 <- subset(Censo2005, DepAdm == "Municipal")
> Censo2005 <- subset(Censo2005, Municipio != "Total")
> Censo2005 <- subset(Censo2005, UF != "Brasil")
> str(Censo2005)
`data.frame':   5559 obs. of  5 variables:
 $ UF           : chr  "Acre" "Acre" "Acre" "Acre" ...
 $ Municipio    : chr  "ACRELANDIA" "ASSIS BRASIL" "BRASILEIA" "BUJARI" ...
 $ DepAdm       : chr  "Municipal" "Municipal" "Municipal" "Municipal" ...
 $ EnsinoFund1_4: num  1424  699 1921  838 1194 ...
 $ EnsinoFund5_8: num  314 121 392 84 102 0 174 187 377 534 ...

Também poderíamos ter feito a filtragem dos dados da seguinte forma:

> Censo2005 <- subset(Censo2005, DepAdm == "Municipal" & Municipio != "Total" & UF != "Brasil")

Agora os dados estão prontos para serem utilizados. Para implementar o teste dos primeiros dígitos escrevi a função benford() cujo uso será apresentado a seguir. Antes, porém, gostaria de observar que a função encontra-se ainda num estágio bem inicial de desenvolvimento, faltando ainda implementar teste de ajustamento (qui-quadrado), teste z para cada um dos dígitos e a implementação de outros testes baseados na lei de benford, como o teste do segundo dígito e o teste dos dois primeiros dígitos, entre outras pequenas coisas.

>benford(Censo2005$EnsinoFund1_4)
  Digits freqEsp freqObs      dif
1      1 0.30103 0.29758  0.00345
2      2 0.17609 0.18715 -0.01106
3      3 0.12494 0.12944  -0.0045
4      4 0.09691 0.09776 -0.00085
5      5 0.07918  0.0792   -2e-05
6      6 0.06695 0.06359  0.00336
7      7 0.05799 0.04797  0.01002
8      8 0.05115 0.04843  0.00273
9      9 0.04576 0.04888 -0.00312





>benford(Censo2005$EnsinoFund5_8)
  Digits freqEsp freqObs      dif
1      1 0.30103 0.32578 -0.02475
2      2 0.17609 0.16693  0.00917
3      3 0.12494 0.11821  0.00673
4      4 0.09691 0.09525  0.00166
5      5 0.07918 0.07229  0.00689
6      6 0.06695 0.07136 -0.00442
7      7 0.05799 0.05213  0.00587
8      8 0.05115 0.05492 -0.00377
9      9 0.04576 0.04313  0.00263



PARA SABER MAIS...

Browne, Malcolm W. - "Following Benford's Law, or Looking Out for No 1" The New York Times, Tuesday, August 4, 1998

Smith, Curtis A. - "Detecting Anomalies in Your Data Using Benford's Law"

Nigrini, Mark J. - "I've Got Your Number" Journal of Accountancy 187, pp.79-83, Mai 1999

Nigrini, Mark J. - "Excerpt from: Digital Analysis Using Benford's Law"

Nigrini, Mark J. - "Digital Analysis: a computer-assisted data analysis technology for internal auditors" ITAudit vol 1, December 15,1998

Lanza, Richard - "Digital Analysis - Real World Examples" ITAudit vol.2, July 1, 1999

Weisstein, Eric W. - "Benford's Law" MathWorld - A Wolfram Web Resource
